{"version":3,"file":"index.js","sources":["../../src/Attachment.ts","../../src/encryption/Ciphertext.ts","../../src/encryption/crypto.browser.ts","../../src/encryption/encryption.ts","../../src/RemoteAttachment.ts"],"sourcesContent":[null,null,null,null,null],"names":["ContentTypeAttachment","ContentTypeId","authorityId","typeId","versionMajor","versionMinor","AttachmentCodec","contentType","encode","content","type","parameters","filename","mimeType","data","decode","fallback","shouldPush","Ciphertext","aes256GcmHkdfSha256","constructor","obj","Error","payload","length","hkdfSalt","gcmNonce","this","toBytes","ciphertext","finish","fromBytes","bytes","crypto","window","hkdfNoInfo","Uint8Array","buffer","aesGcmParams","nonce","additionalData","name","iv","async","hkdf","secret","salt","key","subtle","importKey","deriveKey","hash","info","ContentTypeRemoteAttachment","RemoteAttachmentCodec","load","remoteAttachment","codecRegistry","response","fetch","url","ok","status","statusText","arrayBuffer","digestBytes","digest","secp","etc","bytesToHex","contentDigest","encodedContentData","encrypted","decrypted","decrypt","encodedContent","proto","EncodedContent","codec","codecFor","encodeEncrypted","getRandomValues","plain","encrypt","startsWith","scheme","contentLength","String","TextEncoder","TextDecoder","hexToBytes","parseInt"],"mappings":"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"}